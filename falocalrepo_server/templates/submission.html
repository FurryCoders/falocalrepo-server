<!DOCTYPE html>
<!--suppress HtmlDeprecatedAttribute, HtmlUnknownTarget, CssUnusedSymbol -->
<html lang="en">
<head>
    <title>{{ title }} Â· {{ app }}</title>
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport">
    <meta content="ie=edge" http-equiv="x-ua-compatible">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="icon" href="/touch-icon.png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png">
    <link rel="stylesheet" href="/static/styles/bootstrap.min.css">
    <link rel="stylesheet" href="/static/styles/style.css">
    <style>
        #file-container-sticky .fit-height {
            max-height: 50vh;
        }
    </style>
</head>
<body class="mt-3 mt-lg-4 mb-4">

{% set file %}
{% if submission["FILESAVED"] < 2 %}
<div class="mt-1 mb-2 mt-lg-5 pt-lg-5 text-center">
    <span class="badge bg-danger">Submission has no file</span>
</div>
{% elif submission["TYPE"].lower() == "image" %}
<div class="text-center">
    <div class="error-file mt-1 mb-2 mt-lg-5 pt-lg-5" hidden>
        <span class="badge bg-danger">Image not found</span>
    </div>
    <div class="spinner mt-2 mb-2 mt-lg-5 pt-lg-5">
        <span class="spinner spinner-border spinner-border-sm" role="status"></span>
    </div>
    <img class="img-fluid mx-auto fit-height zoom"
         src="/submission/{{ submission["ID"] }}/file/{{ filename_id }}" alt=""
         onclick="if (this.classList.contains('fit-height')) {this.classList.remove('fit-height'); this.classList.add('zoomed'); document.getElementById('file-container-lg').classList.add('col-12', 'mb-3')} else {this.classList.add('fit-height'); this.classList.remove('zoomed'); document.getElementById('file-container-lg').classList.remove('col-12', 'mb-3')}"
         onload="this.parentNode.querySelector('.spinner').hidden = true; document.getElementById('button-sticky').hidden = this.hidden = false"
         onerror="this.parentNode.querySelector('.spinner').hidden = true; this.parentNode.querySelector('.error-file').hidden = false"
         hidden>
</div>
{% elif submission["TYPE"].lower() == "music" %}
<div class="text-center mb-1 mt-lg-5 pt-lg-5">
    <div class="col-12">
        <span class="mt-2 badge bg-danger" hidden>Thumbnail not found</span>
        <img class="rounded mt-2" src="/submission/{{ submission["ID"] }}/thumbnail" alt=""
             onload="this.hidden = false"
             onerror="this.previousElementSibling.querySelector('.error-thumbnail').hidden = false" hidden>
    </div>
    <span class="mt-2 badge bg-danger" hidden>File not found</span>
    <audio class="mt-2" src="/submission/{{ submission["ID"] }}/file/{{ filename_id }}"
           onerror="this.hidden = true; this.previousElementSibling.querySelector('.error-file').hidden = false"
           style=""
           controls>
    </audio>
</div>
{% elif file_text is not none %}
<div class="border-lg rounded p-2 text-start font-monospace small overflow-scroll text-wrap fit-height">
    {% autoescape false %}{{ file_text.strip() }}{% endautoescape %}
</div>
{% else %}
<div class="text-center mb-2 mt-lg-5 pt-lg-5">
    <div class="col-12">
        <span class="mt-2 badge bg-danger" hidden>Thumbnail not found</span>
        <img class="rounded mt-2" src="/submission/{{ submission["ID"] }}/thumbnail" alt=""
             onload="this.hidden = false"
             onerror="this.previousElementSibling.hidden = false" hidden>
    </div>
    <a class="mt-2 btn btn-sm btn-primary" href="/submission/{{ submission["ID"] }}/file/{{ filename_id }}">
        {{ filename|title }}
    </a>
</div>
{% endif %}
{% endset %}

<div class="container">
    {% if submission["TYPE"].lower() == "image" %}
        <div class="text-center d-lg-none sticky-top mb-2 rounded bg-body bg-opacity-50" id="file-container-sticky"
             hidden>
            {{ file }}
        </div>
    {% endif %}

    <div class="row align-middle">
        <div class="d-none d-lg-block col-8" id="file-container-lg">{{ file }}</div>

        <div class="col-12 col-lg-4 mx-auto">
            <div class="card h-100">
                <h2 class="card-header">{{ submission["TITLE"] }}</h2>
                <div class="card-header text-center d-lg-none p-0" id="file-container-sm">
                    {{ file }}
                </div>
                <div class="card-header text-center d-lg-none">
                    <div class="btn-group col-12 col-md-8" role="group">
                        <a class="btn btn-sm btn-primary {{ "disabled" if not next }}" href="/submission/{{ next }}">
                            Next
                        </a>
                        <span class="btn-separator"></span>
                        <a class="btn btn-sm btn-primary" href="/gallery/{{ submission["AUTHOR"] }}">Gallery</a>
                        <span class="btn-separator"></span>
                        <a class="btn btn-sm btn-primary" href="/submissions/{{ submission["AUTHOR"] }}">All</a>
                        <span class="btn-separator"></span>
                        <a class="btn btn-sm btn-primary" href="/scraps/{{ submission["AUTHOR"] }}">Scraps</a>
                        <span class="btn-separator"></span>
                        <a class="btn btn-sm btn-primary {{ "disabled" if not prev }}" href="/submission/{{ prev }}">
                            Prev
                        </a>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <h6 class="col-4 card-title">Author</h6>
                        <div class="col-8 card-text">
                            <a class="col-8 card-text btn-sm btn-primary badge w-100 text-truncate text-decoration-none"
                               href="/user/{{ submission["AUTHOR"] }}">{{ submission["AUTHOR"] }}
                            </a>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Date</h6>
                        <div class="col-8 card-text">
                            <a class="btn-sm btn-primary badge text-truncate text-decoration-none w-100"
                               href="/search/submissions/?query=%40date%20{{ submission["DATE"].strftime("%Y-%m-%d") }}">
                                {{ submission["DATE"].strftime("%Y-%m-%d %H:%M") }}
                            </a>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Folder</h6>
                        <div class="col-8 card-text">
                            <a class="btn-sm btn-primary badge w-100 text-truncate text-decoration-none"
                               href="/{{ submission["FOLDER"] }}/{{ submission["AUTHOR"] }}">
                                {{ submission["FOLDER"]|title }}
                            </a>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Type</h6>
                        <div class="col-8 card-text">
                            <a class="btn-sm btn-primary badge w-100 text-truncate text-decoration-none"
                               href="/search/submissions/?query=%40type%20%22{{ submission["TYPE"] }}%22">
                                {{ submission["TYPE"]|title }}
                            </a>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Category</h6>
                        <div class="col-8 card-text">
                            <a class="btn-sm btn-primary badge w-100 text-truncate text-decoration-none"
                               href="/search/submissions/?query=%40category%20%22{{ submission["CATEGORY"] }}%22">
                                {{ submission["CATEGORY"]|title }}
                            </a>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Species</h6>
                        <div class="col-8 card-text">
                            <a class="btn-sm btn-primary badge w-100 text-truncate text-decoration-none"
                               href="/search/submissions/?query=%40species%20%22{{ submission["SPECIES"] }}%22">
                                {{ submission["SPECIES"]|title }}
                            </a>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Gender</h6>
                        <div class="col-8 card-text">
                            <a class="btn-sm btn-primary badge w-100 text-truncate text-decoration-none"
                               href="/search/submissions/?query=%40gender%20%22{{ submission["GENDER"] }}%22">
                                {{ submission["GENDER"]|title }}
                            </a>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Rating</h6>
                        <div class="col-8 card-text">
                            <a class="btn-sm btn-primary badge w-100 text-truncate text-decoration-none"
                               href="/search/submissions/?query=%40rating%20%22{{ submission["RATING"] }}%22">
                                {{ submission["RATING"]|title }}
                            </a>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Tags</h6>
                        <div class="col-8 card-text">
                            {% for tag in submission["TAGS"] %}
                                <a class="btn-sm btn-primary badge text-truncate text-decoration-none"
                                   href='/search/submissions/?query=%40tags%20%22%7C{{ tag }}%7C%22'>{{ tag }}</a>
                            {% endfor %}
                            {% if not submission["TAGS"] %}
                                <span class="badge bg-danger w-100 text-truncate">No tags</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Favorites</h6>
                        <div class="col-8 card-text">
                            {% for user in submission["FAVORITE"] %}
                                <a class="btn-sm btn-primary badge text-truncate text-decoration-none"
                                   href="/user/{{ user }}">{{ user }}</a>
                            {% endfor %}
                            {% if not submission["FAVORITE"] %}
                                <span class="badge bg-danger w-100 text-truncate">No favorites</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row mt-1">
                        <h6 class="col-4 card-title">Mentions</h6>
                        <div class="col-8 card-text">
                            {% for user in submission["MENTIONS"] %}
                                <a class="btn-sm btn-primary badge text-truncate text-decoration-none"
                                   href="/user/{{ user }}">{{ user }}</a>
                            {% endfor %}
                            {% if not submission["MENTIONS"] %}
                                <span class="badge bg-danger w-100 text-truncate">No mentions</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="card-footer text-center">
                    <div class="row text-center">
                        <div class="btn-group col-8 col-md-6 col-lg-8 ms-auto" role="group">
                            <a class="btn btn-sm btn-secondary disabled">Download</a>
                            <span class="btn-separator"></span>
                            <a class="btn btn-sm btn-primary {{ "disabled" if submission["FILESAVED"] < 2 }}"
                               href="/submission/{{ submission["ID"] }}/file/{{ filename_id }}" download>
                                File
                            </a>
                            <span class="btn-separator"></span>
                            <a class="btn btn-sm btn-primary"
                               href="/submission/{{ submission["ID"] }}/zip/submission-{{ "{0:010}".format(submission["ID"]) }}.zip">
                                ZIP
                            </a>
                        </div>
                        <div class="btn-group col-4 col-md-2 col-lg-4 me-auto">
                            <a class="btn btn-sm btn-primary"
                               href="https://www.furaffinity.net/view/{{ submission["ID"] }}">
                                FA
                            </a>
                        </div>
                        <div class="btn-group col-12 mt-1 d-none d-lg-flex" role="group">
                            <a class="btn btn-sm btn-primary {{ "disabled" if not next }}"
                               href="/submission/{{ next }}">
                                Next
                            </a>
                            <span class="btn-separator"></span>
                            <a class="btn btn-sm btn-primary" href="/gallery/{{ submission["AUTHOR"] }}">Gallery</a>
                            <span class="btn-separator"></span>
                            <a class="btn btn-sm btn-primary" href="/submissions/{{ submission["AUTHOR"] }}">All</a>
                            <span class="btn-separator"></span>
                            <a class="btn btn-sm btn-primary" href="/scraps/{{ submission["AUTHOR"] }}">Scraps</a>
                            <span class="btn-separator"></span>
                            <a class="btn btn-sm btn-primary {{ "disabled" if not prev }}"
                               href="/submission/{{ prev }}">
                                Prev
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-3">
        <div class="col-12">
            <div class="card">
                <div class="card-body col-12 col-lg-9 mx-auto">
                    <div class="card-text text-wrap overflow-hidden">
                        {% autoescape false %}{{ submission["DESCRIPTION"] }}{% endautoescape %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% if comments %}{% include "comments.html" %}{% endif %}

    {% if submission["TYPE"].lower() == "image" %}
        <div class="position-fixed d-lg-none" style="bottom: .25rem; right: .25rem;" id="button-sticky" hidden>
            <button class="btn btn-sm btn-secondary btn-circle"
                    onclick="const c1 = document.getElementById('file-container-sticky'), c2 = document.getElementById('file-container-sm'); c2.hidden = !(c1.hidden = !c1.hidden)">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="mb-1"
                     viewBox="0 0 16 16">
                    <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"></path>
                    <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"></path>
                </svg>
            </button>
        </div>
    {% endif %}
</div>
</body>
</html>
